<!DOCTYPE html>
<html lang="zh-CN" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>秒表 - iPhone风格</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- SF Pro Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    fontFamily: {
                        'sf-pro': ['Inter', 'system-ui', 'sans-serif'],
                    },
                    colors: {
                        'iphone-green': '#34C759',
                        'iphone-red': '#FF3B30',
                        'iphone-orange': '#FF9500',
                        'iphone-blue': '#007AFF',
                        'iphone-gray': '#8E8E93',
                        'iphone-bg': '#000000',
                        'iphone-surface': '#1C1C1E',
                        'iphone-surface-light': '#F2F2F7',
                    },
                    animation: {
                        'pulse-ring': 'pulseRing 1.5s ease-out infinite',
                        'fade-in': 'fadeIn 0.3s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                    },
                    keyframes: {
                        pulseRing: {
                            '0%': { transform: 'scale(1)', opacity: '1' },
                            '100%': { transform: 'scale(1.1)', opacity: '0' },
                        },
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        },
                    }
                }
            }
        }
    </script>
    
    <style>
        body { 
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* 自定义滚动条 */
        .custom-scrollbar::-webkit-scrollbar {
            width: 3px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: transparent;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.3);
            border-radius: 10px;
        }
        .dark .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* 数字字体样式 */
        .timer-digit {
            font-variant-numeric: tabular-nums;
            letter-spacing: -0.02em;
        }
        
        /* 按钮按下效果 */
        .btn-press:active {
            transform: scale(0.95);
        }
        
        /* 玻璃效果 */
        .glass-effect {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }
        
        /* 毛玻璃背景 */
        .frosted-bg {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
        }
    </style>
</head>
<body class="bg-iphone-bg dark:bg-iphone-surface-light text-white min-h-screen transition-colors duration-300">
    
    <!-- 状态栏 -->
    <div class="fixed top-0 left-0 right-0 z-50 px-6 py-2 flex justify-between items-center text-xs">
        <span id="currentTime" class="font-medium">9:41</span>
        <div class="flex items-center gap-1">
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
                <path d="M2 17h20v2H2v-2zm1.15-4.05L4 11.47l.85 1.48 1.3-.75-.85-1.48H7v-1.5H5.3l.85-1.48L4.85 7 4 8.47 3.15 7l-1.3.75.85 1.48H1v1.5h1.7l-.85 1.48 1.3.75zm6.7-.75l1.48.85 1.48-.85-.85-1.48H14v-1.5h-2.05l.85-1.48L11.33 7 9.85 8.47 8.37 7l-1.48.85.85 1.48H6v1.5h1.7l-.85 1.48zm8 0l1.48.85 1.48-.85-.85-1.48H22v-1.5h-2.05l.85-1.48L19.33 7l-1.48 1.47L16.37 7l-1.48.85.85 1.48H14v1.5h1.7l-.85 1.48z"/>
            </svg>
            <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
                <path d="M1 9l2-2v8a2 2 0 002 2h14a2 2 0 002-2V7l2 2V7l-3-3-3 3v2l2-2v8H3V7l2 2V7L2 4 1 7v2z"/>
            </svg>
            <svg class="w-6 h-4" viewBox="0 0 30 20" fill="currentColor">
                <rect x="1" y="6" width="4" height="8" rx="1"/>
                <rect x="7" y="3" width="4" height="11" rx="1"/>
                <rect x="13" y="8" width="4" height="6" rx="1"/>
                <rect x="19" y="2" width="4" height="12" rx="1"/>
                <rect x="25" y="5" width="4" height="9" rx="1"/>
            </svg>
        </div>
    </div>

    <!-- 主容器 -->
    <main class="pt-12 pb-20 min-h-screen flex flex-col">
        
        <!-- 标题栏 -->
        <header class="px-6 py-4">
            <h1 class="text-3xl font-thin text-center">秒表</h1>
        </header>

        <!-- 计时器显示 -->
        <section class="flex-1 flex flex-col items-center justify-center px-6">
            <!-- 主计时显示 -->
            <div class="mb-16">
                <div class="timer-digit text-7xl lg:text-8xl font-thin tracking-tight text-center">
                    <span id="minutes">00</span><span class="inline-block w-8">:</span><span id="seconds">00</span><span class="text-5xl lg:text-6xl">.<span id="milliseconds">00</span></span>
                </div>
            </div>

            <!-- 控制按钮 -->
            <div class="flex items-center gap-8 mb-12">
                <!-- 计次按钮 -->
                <button id="lapBtn" onclick="recordLap()" 
                    class="w-20 h-20 rounded-full border-2 border-white/30 flex items-center justify-center text-white font-medium transition-all duration-200 opacity-0 pointer-events-none btn-press"
                    disabled>
                    计次
                </button>

                <!-- 开始/暂停按钮 -->
                <button id="startBtn" onclick="toggleTimer()" 
                    class="relative w-32 h-32 rounded-full bg-iphone-green flex items-center justify-center transition-all duration-200 hover:scale-105 btn-press shadow-2xl">
                    <span id="startBtnText" class="text-3xl font-medium">开始</span>
                    <div id="pulseRing" class="absolute inset-0 rounded-full bg-iphone-green opacity-0"></div>
                </button>

                <!-- 复位按钮 -->
                <button id="resetBtn" onclick="resetTimer()" 
                    class="w-20 h-20 rounded-full border-2 border-white/30 flex items-center justify-center text-white font-medium transition-all duration-200 opacity-0 pointer-events-none btn-press"
                    disabled>
                    复位
                </button>
            </div>

            <!-- 计次列表 -->
            <div id="lapsContainer" class="w-full max-w-md max-h-64 overflow-y-auto custom-scrollbar space-y-2 opacity-0 transition-opacity duration-300">
                <!-- 计次项目将动态插入这里 -->
            </div>
        </section>

        <!-- 底部标签栏 -->
        <nav class="fixed bottom-0 left-0 right-0 frosted-bg border-t border-white/10">
            <div class="flex justify-around items-center py-2">
                <button class="flex flex-col items-center gap-1 p-2 text-white transition-colors">
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"/>
                    </svg>
                    <span class="text-xs">秒表</span>
                </button>
                
                <button onclick="location.href='index.html'" class="flex flex-col items-center gap-1 p-2 text-iphone-gray transition-colors">
                    <svg class="w-6 h-6" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                    </svg>
                    <span class="text-xs">计时器</span>
                </button>
            </div>
        </nav>
    </main>

    <script>
        // 秒表状态
        let startTime = 0;
        let elapsedTime = 0;
        let timerInterval = null;
        let isRunning = false;
        let laps = [];

        // DOM 元素
        const minutesEl = document.getElementById('minutes');
        const secondsEl = document.getElementById('seconds');
        const millisecondsEl = document.getElementById('milliseconds');
        const startBtn = document.getElementById('startBtn');
        const startBtnText = document.getElementById('startBtnText');
        const lapBtn = document.getElementById('lapBtn');
        const resetBtn = document.getElementById('resetBtn');
        const lapsContainer = document.getElementById('lapsContainer');
        const pulseRing = document.getElementById('pulseRing');

        // 初始化
        document.addEventListener('DOMContentLoaded', () => {
            updateCurrentTime();
            setInterval(updateCurrentTime, 1000);
            
            // 检查系统主题
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches) {
                document.body.classList.add('dark');
            }
        });

        // 更新当前时间
        function updateCurrentTime() {
            const now = new Date();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            document.getElementById('currentTime').textContent = `${hours}:${minutes.toString().padStart(2, '0')}`;
        }

        // 格式化时间
        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const minutes = Math.floor(totalSeconds / 60);
            const seconds = totalSeconds % 60;
            const milliseconds = Math.floor((ms % 1000) / 10);
            
            return {
                minutes: minutes.toString().padStart(2, '0'),
                seconds: seconds.toString().padStart(2, '0'),
                milliseconds: milliseconds.toString().padStart(2, '0')
            };
        }

        // 更新显示
        function updateDisplay() {
            const time = formatTime(elapsedTime);
            minutesEl.textContent = time.minutes;
            secondsEl.textContent = time.seconds;
            millisecondsEl.textContent = time.milliseconds;
        }

        // 开始/暂停计时器
        function toggleTimer() {
            if (!isRunning) {
                startTimer();
            } else {
                pauseTimer();
            }
        }

        // 开始计时
        function startTimer() {
            startTime = Date.now() - elapsedTime;
            timerInterval = setInterval(() => {
                elapsedTime = Date.now() - startTime;
                updateDisplay();
            }, 10);
            
            isRunning = true;
            startBtn.classList.remove('bg-iphone-green');
            startBtn.classList.add('bg-iphone-orange');
            startBtnText.textContent = '暂停';
            
            // 显示计次和复位按钮
            lapBtn.disabled = false;
            lapBtn.classList.remove('opacity-0', 'pointer-events-none');
            lapBtn.classList.add('opacity-100');
            
            resetBtn.disabled = false;
            resetBtn.classList.remove('opacity-0', 'pointer-events-none');
            resetBtn.classList.add('opacity-100');
            
            // 脉冲动画
            pulseRing.style.opacity = '0.3';
            pulseRing.classList.add('animate-pulse-ring');
        }

        // 暂停计时
        function pauseTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            
            startBtn.classList.remove('bg-iphone-orange');
            startBtn.classList.add('bg-iphone-green');
            startBtnText.textContent = '继续';
            
            // 停止脉冲动画
            pulseRing.style.opacity = '0';
            pulseRing.classList.remove('animate-pulse-ring');
        }

        // 复位计时器
        function resetTimer() {
            clearInterval(timerInterval);
            isRunning = false;
            elapsedTime = 0;
            laps = [];
            
            updateDisplay();
            
            // 重置按钮状态
            startBtn.classList.remove('bg-iphone-orange');
            startBtn.classList.add('bg-iphone-green');
            startBtnText.textContent = '开始';
            
            lapBtn.disabled = true;
            lapBtn.classList.add('opacity-0', 'pointer-events-none');
            lapBtn.classList.remove('opacity-100');
            
            resetBtn.disabled = true;
            resetBtn.classList.add('opacity-0', 'pointer-events-none');
            resetBtn.classList.remove('opacity-100');
            
            // 清空计次列表
            lapsContainer.innerHTML = '';
            lapsContainer.classList.remove('opacity-100');
            lapsContainer.classList.add('opacity-0');
            
            // 停止脉冲动画
            pulseRing.style.opacity = '0';
            pulseRing.classList.remove('animate-pulse-ring');
        }

        // 记录计次
        function recordLap() {
            if (!isRunning) return;
            
            const lapTime = elapsedTime;
            const lapNumber = laps.length + 1;
            
            // 计算与上一圈的差值
            let lapDiff = lapTime;
            if (laps.length > 0) {
                lapDiff = lapTime - laps[laps.length - 1].time;
            }
            
            laps.push({
                number: lapNumber,
                time: lapTime,
                diff: lapDiff
            });
            
            // 添加计次显示
            const lapElement = createLapElement(lapNumber, lapTime, lapDiff);
            lapsContainer.insertBefore(lapElement, lapsContainer.firstChild);
            
            // 显示计次容器
            if (laps.length === 1) {
                lapsContainer.classList.remove('opacity-0');
                lapsContainer.classList.add('opacity-100');
            }
            
            // 触觉反馈（如果支持）
            if (navigator.vibrate) {
                navigator.vibrate(10);
            }
        }

        // 创建计次元素
        function createLapElement(number, time, diff) {
            const lapDiv = document.createElement('div');
            lapDiv.className = 'flex justify-between items-center px-4 py-3 glass-effect rounded-lg animate-slide-up';
            
            const timeStr = formatTime(time);
            const diffStr = formatTime(diff);
            
            lapDiv.innerHTML = `
                <div class="flex items-center gap-4">
                    <span class="text-iphone-gray text-sm">计次 ${number}</span>
                </div>
                <div class="flex items-center gap-4">
                    <span class="text-sm text-iphone-gray">${diffStr.minutes}:${diffStr.seconds}.${diffStr.milliseconds}</span>
                    <span class="timer-digit text-lg">${timeStr.minutes}:${timeStr.seconds}.${timeStr.milliseconds}</span>
                </div>
            `;
            
            return lapDiv;
        }

        // 键盘快捷键
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                toggleTimer();
            } else if (e.code === 'KeyL' && isRunning) {
                recordLap();
            } else if (e.code === 'KeyR' && !isRunning && elapsedTime > 0) {
                resetTimer();
            }
        });

        // 防止页面滚动（移动端）
        document.addEventListener('touchmove', (e) => {
            if (e.target.closest('button')) return;
            e.preventDefault();
        }, { passive: false });
    </script>
</body>
</html>
